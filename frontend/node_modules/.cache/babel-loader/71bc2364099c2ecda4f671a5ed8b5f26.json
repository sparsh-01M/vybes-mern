{"ast":null,"code":"var _jsxFileName = \"/Users/sparshsinghal/Downloads/vybes-mern-main/frontend/src/components/Profile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport \"./Profile.css\";\nimport VideoCard from \"./VideoCard\";\nimport PostDetail from \"./PostDetail\";\nimport ProfilePic from \"./ProfilePic\";\nimport { useParams, useNavigate, useLocation } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport { UserContext } from \"../App\";\nimport ReelCard from \"./ReelCard\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Profile() {\n  _s();\n\n  const navigate = useNavigate();\n  const location = useLocation();\n  const {\n    userid\n  } = useParams();\n  const picLink = \"https://cdn-icons-png.flaticon.com/128/3177/3177440.png\"; // State declarations\n\n  const [pic, setPic] = useState([]);\n  const [show, setShow] = useState(false);\n  const [posts, setPosts] = useState([]);\n  const [user, setUser] = useState(\"\");\n  const [videos, setVideos] = useState([]);\n  const [reels, setReels] = useState([]);\n  const [activeTab, setActiveTab] = useState('posts');\n  const [loading, setLoading] = useState(true);\n  const [isFollow, setIsFollow] = useState(false);\n  const [userProfile, setUserProfile] = useState(null);\n  const [showProfilePic, setShowProfilePic] = useState(false); // Set active tab from navigation state\n\n  useEffect(() => {\n    var _location$state;\n\n    if ((_location$state = location.state) !== null && _location$state !== void 0 && _location$state.activeTab) {\n      setActiveTab(location.state.activeTab); // If we came from a post, ensure we're on the profile tab\n\n      if (location.state.fromPost) {\n        // Clear the state after using it\n        navigate(location.pathname, {\n          replace: true,\n          state: {\n            activeTab: 'posts'\n          } // Keep the posts tab active\n\n        });\n      } else {\n        // Clear the state after using it\n        navigate(location.pathname, {\n          replace: true,\n          state: {}\n        });\n      }\n    }\n  }, [location.state, navigate, location.pathname]);\n  const fetchData = useCallback(async () => {\n    try {\n      var _fetchedUserData$user;\n\n      setLoading(true);\n      const token = localStorage.getItem(\"jwt\");\n\n      if (!token) {\n        console.log(\"No JWT token found\");\n        toast.error(\"Please login to view profile\");\n        return;\n      } // Get user ID from token or params\n\n\n      const storedUserData = JSON.parse(localStorage.getItem(\"user\"));\n\n      if (!storedUserData || !storedUserData._id) {\n        console.error(\"No user data found in localStorage\");\n        toast.error(\"User data not found. Please login again.\");\n        return;\n      }\n\n      const userId = userid || storedUserData._id;\n      console.log(\"Fetching data for user:\", userId); // Fetch user data and posts\n\n      const userRes = await fetch(`http://localhost:4000/user/${userId}`, {\n        headers: {\n          Authorization: \"Bearer \" + token\n        }\n      });\n\n      if (!userRes.ok) {\n        const errorText = await userRes.text();\n        console.error(\"User data fetch failed:\", {\n          status: userRes.status,\n          statusText: userRes.statusText,\n          error: errorText\n        });\n        throw new Error(`Failed to fetch user data: ${userRes.status} ${userRes.statusText}`);\n      }\n\n      const fetchedUserData = await userRes.json();\n      console.log(\"User data response:\", fetchedUserData);\n\n      if (!fetchedUserData || !fetchedUserData.user) {\n        console.error(\"Invalid user data response:\", fetchedUserData);\n        throw new Error(\"Invalid user data received from server\");\n      }\n\n      setUser(fetchedUserData.user);\n      setUserProfile(fetchedUserData.user);\n      setPosts(fetchedUserData.post || []); // Check if current user is following this profile\n\n      if ((_fetchedUserData$user = fetchedUserData.user.followers) !== null && _fetchedUserData$user !== void 0 && _fetchedUserData$user.includes(storedUserData._id)) {\n        setIsFollow(true);\n      } // Fetch user's videos with correct endpoint\n\n\n      console.log(\"Fetching videos for user:\", userId);\n      const videosRes = await fetch(`http://localhost:4000/video/user/${userId}`, {\n        headers: {\n          Authorization: \"Bearer \" + token\n        }\n      });\n\n      if (!videosRes.ok) {\n        if (videosRes.status === 404) {\n          console.log(\"No videos found for user\");\n          setVideos([]);\n          return;\n        }\n\n        throw new Error(`Failed to fetch videos: ${videosRes.status}`);\n      }\n\n      const videosData = await videosRes.json();\n      console.log(\"Raw videos data:\", videosData);\n      setVideos(Array.isArray(videosData) ? videosData : []);\n    } catch (err) {\n      console.error(\"Error fetching profile data:\", err);\n      console.error(\"Error stack:\", err.stack);\n      setVideos([]);\n      setPosts([]);\n      setUser(null);\n      setUserProfile(null); // More specific error messages\n\n      if (err.message.includes(\"Failed to fetch\")) {\n        toast.error(\"Network error. Please check your connection.\");\n      } else if (err.message.includes(\"Invalid user data\")) {\n        toast.error(\"Invalid user data received. Please try logging in again.\");\n      } else {\n        toast.error(err.message || \"Error loading profile data\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [userid]); // Update useEffect to use fetchData\n\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]); // Add fetchData as dependency\n  // Follow user\n\n  const followUser = async userId => {\n    try {\n      const res = await fetch(\"http://localhost:4000/follow\", {\n        method: \"put\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"jwt\")\n        },\n        body: JSON.stringify({\n          followId: userId\n        })\n      });\n      const data = await res.json();\n      console.log(data);\n      setIsFollow(true); // Update user profile with new follower\n\n      setUserProfile(prev => ({ ...prev,\n        followers: [...((prev === null || prev === void 0 ? void 0 : prev.followers) || []), JSON.parse(localStorage.getItem(\"user\"))._id]\n      }));\n      toast.success(\"Following user\");\n    } catch (err) {\n      console.error(\"Error following user:\", err);\n      toast.error(\"Error following user\");\n    }\n  }; // Unfollow user\n\n\n  const unfollowUser = async userId => {\n    try {\n      const res = await fetch(\"http://localhost:4000/unfollow\", {\n        method: \"put\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"jwt\")\n        },\n        body: JSON.stringify({\n          followId: userId\n        })\n      });\n      const data = await res.json();\n      console.log(data);\n      setIsFollow(false); // Update user profile by removing follower\n\n      setUserProfile(prev => ({ ...prev,\n        followers: ((prev === null || prev === void 0 ? void 0 : prev.followers) || []).filter(id => id !== JSON.parse(localStorage.getItem(\"user\"))._id)\n      }));\n      toast.success(\"Unfollowed user\");\n    } catch (err) {\n      console.error(\"Error unfollowing user:\", err);\n      toast.error(\"Error unfollowing user\");\n    }\n  }; // Update handleVideoUpdate to use correct endpoint\n\n\n  const handleVideoUpdate = () => {\n    const fetchVideos = async () => {\n      try {\n        const token = localStorage.getItem(\"jwt\");\n        const userData = JSON.parse(localStorage.getItem(\"user\"));\n        const userId = userid || userData._id;\n        const videosRes = await fetch(`http://localhost:4000/video/user/${userId}`, {\n          headers: {\n            Authorization: \"Bearer \" + token\n          }\n        });\n\n        if (!videosRes.ok) {\n          throw new Error(`Failed to fetch videos: ${videosRes.status}`);\n        }\n\n        const videosData = await videosRes.json();\n        setVideos(Array.isArray(videosData) ? videosData : []);\n      } catch (err) {\n        console.error(\"Error refetching videos:\", err);\n        toast.error(\"Error refreshing videos\");\n      }\n    };\n\n    fetchVideos();\n  }; // Add function to handle profile picture change\n\n\n  const handleProfilePicChange = () => {\n    setShowProfilePic(false); // Refetch user data to get updated profile picture\n\n    fetchData();\n  };\n\n  const toggleDetails = post => {\n    setShow(!show);\n    setPic(post);\n  }; // Add function to fetch reels\n\n\n  const fetchReels = async () => {\n    try {\n      const token = localStorage.getItem(\"jwt\");\n      const userData = JSON.parse(localStorage.getItem(\"user\"));\n      const userId = userid || userData._id;\n      const reelsRes = await fetch(`http://localhost:4000/reel/user/${userId}`, {\n        headers: {\n          Authorization: \"Bearer \" + token\n        }\n      });\n\n      if (!reelsRes.ok) {\n        throw new Error(`Failed to fetch reels: ${reelsRes.status}`);\n      }\n\n      const reelsData = await reelsRes.json();\n      setReels(Array.isArray(reelsData) ? reelsData : []);\n    } catch (err) {\n      console.error(\"Error fetching reels:\", err);\n      toast.error(\"Error loading reels\");\n    }\n  }; // Update useEffect to fetch reels\n\n\n  useEffect(() => {\n    fetchData();\n    fetchReels();\n  }, [userid]); // Add function to handle reel updates\n\n  const handleReelUpdate = () => {\n    fetchReels();\n  };\n\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile\",\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 12\n    }, this);\n  }\n\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Unable to load profile\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please try refreshing the page or logging in again.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profile\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-frame\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-pic\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: user.Photo ? user.Photo : picLink,\n          alt: \"\",\n          onClick: () => {\n            if (user._id === JSON.parse(localStorage.getItem(\"user\"))._id) {\n              setShowProfilePic(true);\n            } else {\n              navigate(\"/profile\");\n            }\n          },\n          style: {\n            cursor: user._id === JSON.parse(localStorage.getItem(\"user\"))._id ? 'pointer' : 'default'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-data\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"space-between\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: user.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this), user._id !== JSON.parse(localStorage.getItem(\"user\"))._id && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"followBtn\",\n            onClick: () => {\n              if (isFollow) {\n                unfollowUser(user._id);\n              } else {\n                followUser(user._id);\n              }\n            },\n            children: isFollow ? \"Unfollow\" : \"Follow\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-info\",\n          style: {\n            display: \"flex\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [posts ? posts.length : 0, \" posts\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [videos ? videos.length : 0, \" videos\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [user.followers ? user.followers.length : 0, \" followers\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [user.following ? user.following.length : 0, \" following\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      style: {\n        width: \"90%\",\n        opacity: \"0.8\",\n        margin: \"25px auto\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-tabs\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab-button ${activeTab === 'posts' ? 'active' : ''}`,\n        onClick: () => setActiveTab('posts'),\n        children: \"Posts\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab-button ${activeTab === 'videos' ? 'active' : ''}`,\n        onClick: () => setActiveTab('videos'),\n        children: \"Videos\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab-button ${activeTab === 'reels' ? 'active' : ''}`,\n        onClick: () => setActiveTab('reels'),\n        children: \"Reels\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 7\n    }, this), activeTab === 'posts' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"gallery\",\n      children: posts && posts.map(pics => /*#__PURE__*/_jsxDEV(\"img\", {\n        src: pics.photo,\n        className: \"item\",\n        alt: \"\",\n        onClick: () => toggleDetails(pics)\n      }, pics._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 9\n    }, this) : activeTab === 'videos' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"videos-grid\",\n      children: videos && videos.map(video => /*#__PURE__*/_jsxDEV(VideoCard, {\n        video: video,\n        onVideoUpdate: handleVideoUpdate\n      }, video._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reels-grid\",\n      children: reels && reels.map(reel => /*#__PURE__*/_jsxDEV(ReelCard, {\n        reel: reel,\n        onReelUpdate: handleReelUpdate\n      }, reel._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 9\n    }, this), show && /*#__PURE__*/_jsxDEV(PostDetail, {\n      item: pic,\n      toggleDetails: toggleDetails,\n      isProfilePage: true,\n      activeTab: activeTab\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 9\n    }, this), showProfilePic && /*#__PURE__*/_jsxDEV(ProfilePic, {\n      changeprofile: handleProfilePicChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 301,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Profile, \"I2eEjg9HaXnSuQ+8wmLffhMzSBo=\", false, function () {\n  return [useNavigate, useLocation, useParams];\n});\n\n_c = Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","VideoCard","PostDetail","ProfilePic","useParams","useNavigate","useLocation","toast","UserContext","ReelCard","Profile","navigate","location","userid","picLink","pic","setPic","show","setShow","posts","setPosts","user","setUser","videos","setVideos","reels","setReels","activeTab","setActiveTab","loading","setLoading","isFollow","setIsFollow","userProfile","setUserProfile","showProfilePic","setShowProfilePic","state","fromPost","pathname","replace","fetchData","token","localStorage","getItem","console","log","error","storedUserData","JSON","parse","_id","userId","userRes","fetch","headers","Authorization","ok","errorText","text","status","statusText","Error","fetchedUserData","json","post","followers","includes","videosRes","videosData","Array","isArray","err","stack","message","followUser","res","method","body","stringify","followId","data","prev","success","unfollowUser","filter","id","handleVideoUpdate","fetchVideos","userData","handleProfilePicChange","toggleDetails","fetchReels","reelsRes","reelsData","handleReelUpdate","Photo","cursor","display","alignItems","justifyContent","name","length","following","width","opacity","margin","map","pics","photo","video","reel"],"sources":["/Users/sparshsinghal/Downloads/vybes-mern-main/frontend/src/components/Profile.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\nimport \"./Profile.css\";\nimport VideoCard from \"./VideoCard\";\nimport PostDetail from \"./PostDetail\";\nimport ProfilePic from \"./ProfilePic\";\nimport { useParams, useNavigate, useLocation } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport { UserContext } from \"../App\";\nimport ReelCard from \"./ReelCard\";\n\nexport default function Profile() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { userid } = useParams();\n  const picLink = \"https://cdn-icons-png.flaticon.com/128/3177/3177440.png\";\n  \n  // State declarations\n  const [pic, setPic] = useState([]);\n  const [show, setShow] = useState(false);\n  const [posts, setPosts] = useState([]);\n  const [user, setUser] = useState(\"\");\n  const [videos, setVideos] = useState([]);\n  const [reels, setReels] = useState([]);\n  const [activeTab, setActiveTab] = useState('posts');\n  const [loading, setLoading] = useState(true);\n  const [isFollow, setIsFollow] = useState(false);\n  const [userProfile, setUserProfile] = useState(null);\n  const [showProfilePic, setShowProfilePic] = useState(false);\n\n  // Set active tab from navigation state\n  useEffect(() => {\n    if (location.state?.activeTab) {\n      setActiveTab(location.state.activeTab);\n      // If we came from a post, ensure we're on the profile tab\n      if (location.state.fromPost) {\n        // Clear the state after using it\n        navigate(location.pathname, { \n          replace: true, \n          state: { activeTab: 'posts' }  // Keep the posts tab active\n        });\n      } else {\n        // Clear the state after using it\n        navigate(location.pathname, { replace: true, state: {} });\n      }\n    }\n  }, [location.state, navigate, location.pathname]);\n\n  const fetchData = useCallback(async () => {\n    try {\n      setLoading(true);\n      const token = localStorage.getItem(\"jwt\");\n      if (!token) {\n        console.log(\"No JWT token found\");\n        toast.error(\"Please login to view profile\");\n        return;\n      }\n\n      // Get user ID from token or params\n      const storedUserData = JSON.parse(localStorage.getItem(\"user\"));\n      if (!storedUserData || !storedUserData._id) {\n        console.error(\"No user data found in localStorage\");\n        toast.error(\"User data not found. Please login again.\");\n        return;\n      }\n\n      const userId = userid || storedUserData._id;\n      console.log(\"Fetching data for user:\", userId);\n\n      // Fetch user data and posts\n      const userRes = await fetch(`http://localhost:4000/user/${userId}`, {\n        headers: {\n          Authorization: \"Bearer \" + token,\n        },\n      });\n\n      if (!userRes.ok) {\n        const errorText = await userRes.text();\n        console.error(\"User data fetch failed:\", {\n          status: userRes.status,\n          statusText: userRes.statusText,\n          error: errorText\n        });\n        throw new Error(`Failed to fetch user data: ${userRes.status} ${userRes.statusText}`);\n      }\n\n      const fetchedUserData = await userRes.json();\n      console.log(\"User data response:\", fetchedUserData);\n\n      if (!fetchedUserData || !fetchedUserData.user) {\n        console.error(\"Invalid user data response:\", fetchedUserData);\n        throw new Error(\"Invalid user data received from server\");\n      }\n\n      setUser(fetchedUserData.user);\n      setUserProfile(fetchedUserData.user);\n      setPosts(fetchedUserData.post || []);\n\n      // Check if current user is following this profile\n      if (fetchedUserData.user.followers?.includes(storedUserData._id)) {\n        setIsFollow(true);\n      }\n\n      // Fetch user's videos with correct endpoint\n      console.log(\"Fetching videos for user:\", userId);\n      const videosRes = await fetch(`http://localhost:4000/video/user/${userId}`, {\n        headers: {\n          Authorization: \"Bearer \" + token,\n        },\n      });\n\n      if (!videosRes.ok) {\n        if (videosRes.status === 404) {\n          console.log(\"No videos found for user\");\n          setVideos([]);\n          return;\n        }\n        throw new Error(`Failed to fetch videos: ${videosRes.status}`);\n      }\n\n      const videosData = await videosRes.json();\n      console.log(\"Raw videos data:\", videosData);\n      setVideos(Array.isArray(videosData) ? videosData : []);\n    } catch (err) {\n      console.error(\"Error fetching profile data:\", err);\n      console.error(\"Error stack:\", err.stack);\n      setVideos([]);\n      setPosts([]);\n      setUser(null);\n      setUserProfile(null);\n      \n      // More specific error messages\n      if (err.message.includes(\"Failed to fetch\")) {\n        toast.error(\"Network error. Please check your connection.\");\n      } else if (err.message.includes(\"Invalid user data\")) {\n        toast.error(\"Invalid user data received. Please try logging in again.\");\n      } else {\n        toast.error(err.message || \"Error loading profile data\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [userid]);\n\n  // Update useEffect to use fetchData\n  useEffect(() => {\n    fetchData();\n  }, [fetchData]); // Add fetchData as dependency\n\n  // Follow user\n  const followUser = async (userId) => {\n    try {\n      const res = await fetch(\"http://localhost:4000/follow\", {\n        method: \"put\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"jwt\"),\n        },\n        body: JSON.stringify({\n          followId: userId,\n        }),\n      });\n      const data = await res.json();\n      console.log(data);\n      setIsFollow(true);\n      \n      // Update user profile with new follower\n      setUserProfile(prev => ({\n        ...prev,\n        followers: [...(prev?.followers || []), JSON.parse(localStorage.getItem(\"user\"))._id]\n      }));\n      \n      toast.success(\"Following user\");\n    } catch (err) {\n      console.error(\"Error following user:\", err);\n      toast.error(\"Error following user\");\n    }\n  };\n\n  // Unfollow user\n  const unfollowUser = async (userId) => {\n    try {\n      const res = await fetch(\"http://localhost:4000/unfollow\", {\n        method: \"put\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"jwt\"),\n        },\n        body: JSON.stringify({\n          followId: userId,\n        }),\n      });\n      const data = await res.json();\n      console.log(data);\n      setIsFollow(false);\n      \n      // Update user profile by removing follower\n      setUserProfile(prev => ({\n        ...prev,\n        followers: (prev?.followers || []).filter(id => id !== JSON.parse(localStorage.getItem(\"user\"))._id)\n      }));\n      \n      toast.success(\"Unfollowed user\");\n    } catch (err) {\n      console.error(\"Error unfollowing user:\", err);\n      toast.error(\"Error unfollowing user\");\n    }\n  };\n\n  // Update handleVideoUpdate to use correct endpoint\n  const handleVideoUpdate = () => {\n    const fetchVideos = async () => {\n      try {\n        const token = localStorage.getItem(\"jwt\");\n        const userData = JSON.parse(localStorage.getItem(\"user\"));\n        const userId = userid || userData._id;\n\n        const videosRes = await fetch(`http://localhost:4000/video/user/${userId}`, {\n          headers: {\n            Authorization: \"Bearer \" + token,\n          },\n        });\n\n        if (!videosRes.ok) {\n          throw new Error(`Failed to fetch videos: ${videosRes.status}`);\n        }\n\n        const videosData = await videosRes.json();\n        setVideos(Array.isArray(videosData) ? videosData : []);\n      } catch (err) {\n        console.error(\"Error refetching videos:\", err);\n        toast.error(\"Error refreshing videos\");\n      }\n    };\n    fetchVideos();\n  };\n\n  // Add function to handle profile picture change\n  const handleProfilePicChange = () => {\n    setShowProfilePic(false);\n    // Refetch user data to get updated profile picture\n    fetchData();\n  };\n\n  const toggleDetails = (post) => {\n    setShow(!show);\n    setPic(post);\n  };\n\n  // Add function to fetch reels\n  const fetchReels = async () => {\n    try {\n      const token = localStorage.getItem(\"jwt\");\n      const userData = JSON.parse(localStorage.getItem(\"user\"));\n      const userId = userid || userData._id;\n\n      const reelsRes = await fetch(`http://localhost:4000/reel/user/${userId}`, {\n        headers: {\n          Authorization: \"Bearer \" + token,\n        },\n      });\n\n      if (!reelsRes.ok) {\n        throw new Error(`Failed to fetch reels: ${reelsRes.status}`);\n      }\n\n      const reelsData = await reelsRes.json();\n      setReels(Array.isArray(reelsData) ? reelsData : []);\n    } catch (err) {\n      console.error(\"Error fetching reels:\", err);\n      toast.error(\"Error loading reels\");\n    }\n  };\n\n  // Update useEffect to fetch reels\n  useEffect(() => {\n    fetchData();\n    fetchReels();\n  }, [userid]);\n\n  // Add function to handle reel updates\n  const handleReelUpdate = () => {\n    fetchReels();\n  };\n\n  if (loading) {\n    return <div className=\"profile\">Loading...</div>;\n  }\n\n  if (!user) {\n    return (\n      <div className=\"profile\">\n        <div className=\"error-message\">\n          <h2>Unable to load profile</h2>\n          <p>Please try refreshing the page or logging in again.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"profile\">\n      {/* Profile frame */}\n      <div className=\"profile-frame\">\n        {/* profile-pic */}\n        <div className=\"profile-pic\">\n          <img \n            src={user.Photo ? user.Photo : picLink} \n            alt=\"\" \n            onClick={() => {\n              if (user._id === JSON.parse(localStorage.getItem(\"user\"))._id) {\n                setShowProfilePic(true);\n              } else {\n                navigate(\"/profile\");\n              }\n            }}\n            style={{ cursor: user._id === JSON.parse(localStorage.getItem(\"user\"))._id ? 'pointer' : 'default' }}\n          />\n        </div>\n        {/* profile-data */}\n        <div className=\"profile-data\">\n          <div style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"space-between\",\n          }}>\n            <h1>{user.name}</h1>\n            {user._id !== JSON.parse(localStorage.getItem(\"user\"))._id && (\n              <button\n                className=\"followBtn\"\n                onClick={() => {\n                  if (isFollow) {\n                    unfollowUser(user._id);\n                  } else {\n                    followUser(user._id);\n                  }\n                }}\n              >\n                {isFollow ? \"Unfollow\" : \"Follow\"}\n              </button>\n            )}\n          </div>\n          <div className=\"profile-info\" style={{ display: \"flex\" }}>\n            <p>{posts ? posts.length : 0} posts</p>\n            <p>{videos ? videos.length : 0} videos</p>\n            <p>{user.followers ? user.followers.length : 0} followers</p>\n            <p>{user.following ? user.following.length : 0} following</p>\n          </div>\n        </div>\n      </div>\n      <hr\n        style={{\n          width: \"90%\",\n          opacity: \"0.8\",\n          margin: \"25px auto\",\n        }}\n      />\n\n      {/* Tabs */}\n      <div className=\"profile-tabs\">\n        <button\n          className={`tab-button ${activeTab === 'posts' ? 'active' : ''}`}\n          onClick={() => setActiveTab('posts')}\n        >\n          Posts\n        </button>\n        <button\n          className={`tab-button ${activeTab === 'videos' ? 'active' : ''}`}\n          onClick={() => setActiveTab('videos')}\n        >\n          Videos\n        </button>\n        <button\n          className={`tab-button ${activeTab === 'reels' ? 'active' : ''}`}\n          onClick={() => setActiveTab('reels')}\n        >\n          Reels\n        </button>\n      </div>\n\n      {/* Content based on active tab */}\n      {activeTab === 'posts' ? (\n        <div className=\"gallery\">\n          {posts && posts.map((pics) => (\n            <img\n              key={pics._id}\n              src={pics.photo}\n              className=\"item\"\n              alt=\"\"\n              onClick={() => toggleDetails(pics)}\n            />\n          ))}\n        </div>\n      ) : activeTab === 'videos' ? (\n        <div className=\"videos-grid\">\n          {videos && videos.map((video) => (\n            <VideoCard\n              key={video._id}\n              video={video}\n              onVideoUpdate={handleVideoUpdate}\n            />\n          ))}\n        </div>\n      ) : (\n        <div className=\"reels-grid\">\n          {reels && reels.map((reel) => (\n            <ReelCard\n              key={reel._id}\n              reel={reel}\n              onReelUpdate={handleReelUpdate}\n            />\n          ))}\n        </div>\n      )}\n      {show && (\n        <PostDetail \n          item={pic} \n          toggleDetails={toggleDetails} \n          isProfilePage={true}\n          activeTab={activeTab}\n        />\n      )}\n\n      {/* Add ProfilePic modal */}\n      {showProfilePic && (\n        <ProfilePic changeprofile={handleProfilePicChange} />\n      )}\n    </div>\n  );\n} "],"mappings":"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"},"metadata":{},"sourceType":"module"}