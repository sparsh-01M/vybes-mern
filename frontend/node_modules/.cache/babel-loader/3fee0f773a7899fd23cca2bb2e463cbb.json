{"ast":null,"code":"// import React, { useState, useEffect } from 'react';\n// import axios from 'axios';\n// import './AudioBook.css';\n// // AudiobookCard Component\n// const AudiobookCard = ({ audiobook, currentlyPlaying, setCurrentlyPlaying }) => {\n//   const [isPlaying, setIsPlaying] = useState(false);\n//   const [audio] = useState(new Audio(audiobook.audioUrl));\n//   useEffect(() => {\n//     setIsPlaying(currentlyPlaying === audio);\n//     const handleEnded = () => {\n//       setIsPlaying(false);\n//       if (currentlyPlaying === audio) {\n//         setCurrentlyPlaying(null);\n//       }\n//     };\n//     audio.addEventListener('ended', handleEnded);\n//     return () => {\n//       audio.removeEventListener('ended', handleEnded);\n//       audio.pause();\n//     };\n//   }, [audio, currentlyPlaying, setCurrentlyPlaying]);\n//   const togglePlay = () => {\n//     if (isPlaying) {\n//       audio.pause();\n//       setCurrentlyPlaying(null);\n//     } else {\n//       if (currentlyPlaying && currentlyPlaying !== audio) {\n//         currentlyPlaying.pause();\n//       }\n//       audio.play();\n//       setCurrentlyPlaying(audio);\n//     }\n//   };\n//   const truncateText = (text, maxLength) => {\n//     if (!text) return '';\n//     return text.length <= maxLength ? text : `${text.substr(0, maxLength)}...`;\n//   };\n//   return (\n//     <div className=\"audiobook-card\">\n//       <div className=\"audiobook-thumbnail\">\n//         <img src={audiobook.thumbnailUrl} alt={audiobook.title} />\n//         <button \n//           className={`play-button ${isPlaying ? 'playing' : ''}`} \n//           onClick={togglePlay}\n//         >\n//           {isPlaying ? '❚❚' : '▶'}\n//         </button>\n//       </div>\n//       <div className=\"audiobook-info\">\n//         <h3 className=\"audiobook-title\">{truncateText(audiobook.title, 40)}</h3>\n//         <p className=\"audiobook-author\">By {audiobook.author}</p>\n//         <p className=\"audiobook-description\">{truncateText(audiobook.description, 100)}</p>\n//         <p className=\"audiobook-duration\">{audiobook.duration || 'Unknown duration'}</p>\n//       </div>\n//     </div>\n//   );\n// };\n// // Pagination Component\n// const Pagination = ({ currentPage, totalPages, onPageChange }) => {\n//   const getPageNumbers = () => {\n//     const pageNumbers = [];\n//     const maxPagesToShow = 5;\n//     if (totalPages <= maxPagesToShow) {\n//       for (let i = 1; i <= totalPages; i++) pageNumbers.push(i);\n//     } else {\n//       pageNumbers.push(1);\n//       if (currentPage > 3) pageNumbers.push('...');\n//       const startPage = Math.max(2, currentPage - 1);\n//       const endPage = Math.min(totalPages - 1, currentPage + 1);\n//       for (let i = startPage; i <= endPage; i++) {\n//         if (i !== 1 && i !== totalPages) pageNumbers.push(i);\n//       }\n//       if (currentPage < totalPages - 2) pageNumbers.push('...');\n//       pageNumbers.push(totalPages);\n//     }\n//     return pageNumbers;\n//   };\n//   return (\n//     <div className=\"pagination\">\n//       <button \n//         className=\"page-nav\" \n//         onClick={() => onPageChange(currentPage - 1)}\n//         disabled={currentPage === 1}\n//       >\n//         &laquo; Prev\n//       </button>\n//       {getPageNumbers().map((number, index) => (\n//         <button\n//           key={index}\n//           className={`page-number ${number === currentPage ? 'active' : ''}`}\n//           onClick={() => number !== '...' && onPageChange(number)}\n//           disabled={number === '...'}\n//         >\n//           {number}\n//         </button>\n//       ))}\n//       <button \n//         className=\"page-nav\" \n//         onClick={() => onPageChange(currentPage + 1)}\n//         disabled={currentPage === totalPages}\n//       >\n//         Next &raquo;\n//       </button>\n//     </div>\n//   );\n// };\n// // Main App Component\n// function AudiobookApp() {\n//   const [audiobooks, setAudiobooks] = useState([]);\n//   const [loading, setLoading] = useState(true);\n//   const [error, setError] = useState('');\n//   const [currentPage, setCurrentPage] = useState(1);\n//   const [totalPages, setTotalPages] = useState(0);\n//   const [itemsPerPage] = useState(100);\n//   const [currentlyPlaying, setCurrentlyPlaying] = useState(null);\n//   useEffect(() => {\n//     const fetchAudiobooks = async () => {\n//       try {\n//         setLoading(true);\n//         const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5002';\n//         const response = await axios.get(`${API_URL}/api/audiobooks?page=${currentPage}&limit=${itemsPerPage}`);\n//         setAudiobooks(response.data.audiobooks);\n//         setTotalPages(response.data.totalPages);\n//         setLoading(false);\n//       } catch (err) {\n//         const errorMessage = err.response \n//           ? `Error ${err.response.status}: ${err.response.data.message || err.response.statusText}`\n//           : 'Network error: Failed to connect to the server';\n//         setError(errorMessage);\n//         setLoading(false);\n//       }\n//     };\n//     fetchAudiobooks();\n//   }, [currentPage, itemsPerPage]);\n//   const handlePageChange = (pageNumber) => {\n//     setCurrentPage(pageNumber);\n//     if (currentlyPlaying) {\n//       currentlyPlaying.pause();\n//       setCurrentlyPlaying(null);\n//     }\n//   };\n//   if (loading) return <div className=\"loading\">Loading audiobooks...</div>;\n//   if (error) return <div className=\"error\">{error}</div>;\n//   return (\n//     <div className=\"app\">\n//       <header>\n//         <h1>Audiobook Library</h1>\n//       </header>\n//       <main>\n//         <div className=\"audiobook-grid\">\n//           {audiobooks.length > 0 ? (\n//             audiobooks.map(audiobook => (\n//               <AudiobookCard \n//                 key={audiobook._id} \n//                 audiobook={audiobook}\n//                 currentlyPlaying={currentlyPlaying}\n//                 setCurrentlyPlaying={setCurrentlyPlaying}\n//               />\n//             ))\n//           ) : (\n//             <p>No audiobooks found</p>\n//           )}\n//         </div>\n//         <Pagination \n//           currentPage={currentPage}\n//           totalPages={totalPages}\n//           onPageChange={handlePageChange}\n//         />\n//       </main>\n//     </div>\n//   );\n// }\n// export default AudiobookApp;","map":{"version":3,"names":[],"sources":["/Users/sparshsinghal/Downloads/Instagram-mern-stack-main/frontend/src/components/AudioBook.js"],"sourcesContent":["// import React, { useState, useEffect } from 'react';\n// import axios from 'axios';\n// import './AudioBook.css';\n\n// // AudiobookCard Component\n// const AudiobookCard = ({ audiobook, currentlyPlaying, setCurrentlyPlaying }) => {\n//   const [isPlaying, setIsPlaying] = useState(false);\n//   const [audio] = useState(new Audio(audiobook.audioUrl));\n\n//   useEffect(() => {\n//     setIsPlaying(currentlyPlaying === audio);\n    \n//     const handleEnded = () => {\n//       setIsPlaying(false);\n//       if (currentlyPlaying === audio) {\n//         setCurrentlyPlaying(null);\n//       }\n//     };\n    \n//     audio.addEventListener('ended', handleEnded);\n//     return () => {\n//       audio.removeEventListener('ended', handleEnded);\n//       audio.pause();\n//     };\n//   }, [audio, currentlyPlaying, setCurrentlyPlaying]);\n\n//   const togglePlay = () => {\n//     if (isPlaying) {\n//       audio.pause();\n//       setCurrentlyPlaying(null);\n//     } else {\n//       if (currentlyPlaying && currentlyPlaying !== audio) {\n//         currentlyPlaying.pause();\n//       }\n//       audio.play();\n//       setCurrentlyPlaying(audio);\n//     }\n//   };\n\n//   const truncateText = (text, maxLength) => {\n//     if (!text) return '';\n//     return text.length <= maxLength ? text : `${text.substr(0, maxLength)}...`;\n//   };\n\n//   return (\n//     <div className=\"audiobook-card\">\n//       <div className=\"audiobook-thumbnail\">\n//         <img src={audiobook.thumbnailUrl} alt={audiobook.title} />\n//         <button \n//           className={`play-button ${isPlaying ? 'playing' : ''}`} \n//           onClick={togglePlay}\n//         >\n//           {isPlaying ? '❚❚' : '▶'}\n//         </button>\n//       </div>\n//       <div className=\"audiobook-info\">\n//         <h3 className=\"audiobook-title\">{truncateText(audiobook.title, 40)}</h3>\n//         <p className=\"audiobook-author\">By {audiobook.author}</p>\n//         <p className=\"audiobook-description\">{truncateText(audiobook.description, 100)}</p>\n//         <p className=\"audiobook-duration\">{audiobook.duration || 'Unknown duration'}</p>\n//       </div>\n//     </div>\n//   );\n// };\n\n// // Pagination Component\n// const Pagination = ({ currentPage, totalPages, onPageChange }) => {\n//   const getPageNumbers = () => {\n//     const pageNumbers = [];\n//     const maxPagesToShow = 5;\n    \n//     if (totalPages <= maxPagesToShow) {\n//       for (let i = 1; i <= totalPages; i++) pageNumbers.push(i);\n//     } else {\n//       pageNumbers.push(1);\n//       if (currentPage > 3) pageNumbers.push('...');\n      \n//       const startPage = Math.max(2, currentPage - 1);\n//       const endPage = Math.min(totalPages - 1, currentPage + 1);\n      \n//       for (let i = startPage; i <= endPage; i++) {\n//         if (i !== 1 && i !== totalPages) pageNumbers.push(i);\n//       }\n      \n//       if (currentPage < totalPages - 2) pageNumbers.push('...');\n//       pageNumbers.push(totalPages);\n//     }\n//     return pageNumbers;\n//   };\n\n//   return (\n//     <div className=\"pagination\">\n//       <button \n//         className=\"page-nav\" \n//         onClick={() => onPageChange(currentPage - 1)}\n//         disabled={currentPage === 1}\n//       >\n//         &laquo; Prev\n//       </button>\n      \n//       {getPageNumbers().map((number, index) => (\n//         <button\n//           key={index}\n//           className={`page-number ${number === currentPage ? 'active' : ''}`}\n//           onClick={() => number !== '...' && onPageChange(number)}\n//           disabled={number === '...'}\n//         >\n//           {number}\n//         </button>\n//       ))}\n      \n//       <button \n//         className=\"page-nav\" \n//         onClick={() => onPageChange(currentPage + 1)}\n//         disabled={currentPage === totalPages}\n//       >\n//         Next &raquo;\n//       </button>\n//     </div>\n//   );\n// };\n\n// // Main App Component\n// function AudiobookApp() {\n//   const [audiobooks, setAudiobooks] = useState([]);\n//   const [loading, setLoading] = useState(true);\n//   const [error, setError] = useState('');\n//   const [currentPage, setCurrentPage] = useState(1);\n//   const [totalPages, setTotalPages] = useState(0);\n//   const [itemsPerPage] = useState(100);\n//   const [currentlyPlaying, setCurrentlyPlaying] = useState(null);\n\n//   useEffect(() => {\n//     const fetchAudiobooks = async () => {\n//       try {\n//         setLoading(true);\n//         const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5002';\n//         const response = await axios.get(`${API_URL}/api/audiobooks?page=${currentPage}&limit=${itemsPerPage}`);\n//         setAudiobooks(response.data.audiobooks);\n//         setTotalPages(response.data.totalPages);\n//         setLoading(false);\n//       } catch (err) {\n//         const errorMessage = err.response \n//           ? `Error ${err.response.status}: ${err.response.data.message || err.response.statusText}`\n//           : 'Network error: Failed to connect to the server';\n//         setError(errorMessage);\n//         setLoading(false);\n//       }\n//     };\n\n//     fetchAudiobooks();\n//   }, [currentPage, itemsPerPage]);\n\n//   const handlePageChange = (pageNumber) => {\n//     setCurrentPage(pageNumber);\n//     if (currentlyPlaying) {\n//       currentlyPlaying.pause();\n//       setCurrentlyPlaying(null);\n//     }\n//   };\n\n//   if (loading) return <div className=\"loading\">Loading audiobooks...</div>;\n//   if (error) return <div className=\"error\">{error}</div>;\n\n//   return (\n//     <div className=\"app\">\n//       <header>\n//         <h1>Audiobook Library</h1>\n//       </header>\n      \n//       <main>\n//         <div className=\"audiobook-grid\">\n//           {audiobooks.length > 0 ? (\n//             audiobooks.map(audiobook => (\n//               <AudiobookCard \n//                 key={audiobook._id} \n//                 audiobook={audiobook}\n//                 currentlyPlaying={currentlyPlaying}\n//                 setCurrentlyPlaying={setCurrentlyPlaying}\n//               />\n//             ))\n//           ) : (\n//             <p>No audiobooks found</p>\n//           )}\n//         </div>\n        \n//         <Pagination \n//           currentPage={currentPage}\n//           totalPages={totalPages}\n//           onPageChange={handlePageChange}\n//         />\n//       </main>\n//     </div>\n//   );\n// }\n\n// export default AudiobookApp;"],"mappings":"AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA"},"metadata":{},"sourceType":"module"}